<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shporta - Library</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fredericka+the+Great&family=Fraunces:ital,wght@1,500&display=swap"
          rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    <link rel="stylesheet" href="../css/navbar-foot.css">
    <link rel="stylesheet" href="../css/search-suggestions.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <style>
        .cart-container {
            padding: 2rem 0;
            min-height: 60vh;
        }
        .cart-table {
            width: 100%;
            margin-bottom: 2rem;
        }
        .cart-table th {
            background-color: #c98169;
            color: white;
            padding: 1rem;
        }
        .cart-table td {
            padding: 1rem;
            vertical-align: middle;
        }
        .cart-item-image {
            width: 100px;
            height: 150px;
            object-fit: cover;
        }
        .cart-summary {
            background-color: #f8f9fa;
            padding: 1.5rem;
            border-radius: 8px;
        }
        .empty-cart {
            text-align: center;
            padding: 3rem;
        }
        .empty-cart i {
            font-size: 4rem;
            color: #c98169;
            margin-bottom: 1rem;
        }
        .quantity-control {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .quantity-control button {
            background-color: #c98169;
            color: white;
            border: none;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
        }
        .quantity-control input {
            width: 50px;
            text-align: center;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 0.25rem;
        }
        .remove-item {
            color: #dc3545;
            cursor: pointer;
            font-size: 1.2rem;
        }
        .checkout-btn {
            background-color: #c98169;
            color: white;
            padding: 0.75rem 2rem;
            border: none;
            border-radius: 4px;
            font-size: 1.1rem;
            transition: background-color 0.3s;
        }
        .checkout-btn:hover {
            background-color: #b06d5a;
            color: white;
        }
    </style>
</head>
<body>
<header class="main-header" style="background: #c98169;">
    <nav class="navbar navbar-expand-lg navbar-dark" style="background: #c98169;">
        <div class="container-fluid">
            <a class="navbar-brand d-flex align-items-center" href="./home.html">
                <img src="images/logo_2.png" alt="Library Logo"
                     style="height: 65px; border-radius: 50%; margin-right: 0.5rem;">
                <span class="logo-title" style="margin-right: 1.5rem; font-weight: normal;">Library</span>
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbar"
                    aria-controls="mainNavbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="mainNavbar">
                <div class="search-bar">
                    <form action="./search-results.html" method="get">
                        <input type="text" name="q" placeholder="Kërko për një libër" aria-label="Search"
                               class="search-input">
                        <button type="submit" class="search-icon">
                            <i class="bi-search" aria-hidden="true"></i>
                        </button>
                    </form>
                </div>
                <ul class="navbar-nav ms-auto nav-links">
                    <li class="nav-item"><a class="nav-link" href="./home.html">HOME</a></li>
                    <li class="nav-item"><a class="nav-link" href="./about.html">RRETH NESH</a></li>
                    <li class="nav-item"><a class="nav-link" href="./contact.html">KONTAKT</a></li>
                    <li class="nav-item"><a class="nav-link" href="./catalog.html">KATALOG</a></li>
                    <li class="nav-item"><a class="nav-link" href="./event.html">EVENTE</a></li>
                    <li class="nav-item">
                        <a class="cart-icon" href="./cart.html">
                            <i class="bi bi-cart3"></i>
                            <span id="cartCount" class="cart-count">0</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

<main class="cart-container">
    <div class="container">
        <h1 class="mb-4">Shporta Juaj</h1>
        
        <div id="cartContent">
            <!-- Cart items will be dynamically inserted here -->
            <div class="empty-cart" id="emptyCart">
                <i class="bi bi-cart3"></i>
                <h2>Shporta juaj është bosh</h2>
                <p>Shkoni te katalogu për të zgjedhur libra</p>
                <a href="./catalog.html" class="btn btn-primary mt-3">Shiko Katalogun</a>
            </div>

            <div id="cartItems" style="display: none;">
                <div class="table-responsive">
                    <table class="cart-table">
                        <thead>
                            <tr>
                                <th>Libri</th>
                                <th>Titulli</th>
                                <th>Autori</th>
                                <th>Sasia</th>
                                <th>Çmimi</th>
                                <th>Ndrysho</th>
                            </tr>
                        </thead>
                        <tbody id="cartTableBody">
                            <!-- Cart items will be dynamically inserted here -->
                        </tbody>
                    </table>
                </div>

                <div class="row">
                    <div class="col-md-6 offset-md-6">
                        <div class="cart-summary">
                            <h3>Përmbledhje e Porosisë</h3>
                            <div class="d-flex justify-content-between mb-2">
                                <span>Nëntotali:</span>
                                <span id="subtotal">0.00 ALL</span>
                            </div>
                            <div class="d-flex justify-content-between mb-2">
                                <span>Transporti:</span>
                                <span id="shipping">0.00 ALL</span>
                            </div>
                            <hr>
                            <div class="d-flex justify-content-between mb-3">
                                <strong>Totali:</strong>
                                <strong id="total">0.00 ALL</strong>
                            </div>
                            <button class="checkout-btn w-100" id="checkoutBtn">
                                Vazhdo me Porosinë
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<footer>
    <div class="container">
        <div class="row footer-content text-center py-4">
            <div class="col-md-4 mb-3 mb-md-0 footer-logo d-flex flex-column align-items-center">
                <img src="images/logo_2.png" alt="Library Logo"
                     style="height: 105px; border-radius: 50%; margin-bottom: 0.5rem;">
                <div class="logo-title">Library</div>
            </div>

            <div class="col-md-4 mb-3 mb-md-0 footer-text d-flex flex-column align-items-center">
                <p>Na ndiqni ne rrjetet sociale</p>
                <div class="social-icons d-flex justify-content-center gap-3">
                    <a href="#"><i class="bi bi-facebook"></i></a>
                    <a href="#"><i class="bi bi-instagram"></i></a>
                    <a href="#"><i class="bi bi-twitter"></i></a>
                    <a href="#"><i class="bi bi-linkedin"></i></a>
                </div>
                <img src="images/1.png" alt="Library Logo"
                     style="height: 65px; border-radius: 50%; margin-top: 0.5rem;">
            </div>
            <div class="col-md-4 footer-links d-flex flex-column align-items-center gap-2">
                <a href="./home.html">HOME</a>
                <a href="./about.html">RRETH NESH</a>
                <a href="./contact.html">KONTAKT</a>
                <a href="./catalog.html">KATALOG</a>
                <a href="./event.html">EVENTE</a>
            </div>
        </div>
        <p class="text-center mb-0">&copy; 2025 Library. All rights reserved.</p>
    </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="../js/search-suggestions.js"></script>
<script src="../js/cart.js"></script>
<script>
    // Cart page specific JavaScript
    document.addEventListener('DOMContentLoaded', function() {
        const cart = JSON.parse(localStorage.getItem('cart')) || [];
        const emptyCart = document.getElementById('emptyCart');
        const cartItems = document.getElementById('cartItems');
        const cartTableBody = document.getElementById('cartTableBody');
        const subtotalElement = document.getElementById('subtotal');
        const shippingElement = document.getElementById('shipping');
        const totalElement = document.getElementById('total');
        const checkoutBtn = document.getElementById('checkoutBtn');

        function updateCartDisplay() {
            if (cart.length === 0) {
                emptyCart.style.display = 'block';
                cartItems.style.display = 'none';
                return;
            }

            emptyCart.style.display = 'none';
            cartItems.style.display = 'block';

            // Clear existing items
            cartTableBody.innerHTML = '';

            let subtotal = 0;

            // Add each item to the table
            cart.forEach((item, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><img src="${item.image}" alt="${item.title}" class="cart-item-image"></td>
                    <td>${item.title}</td>
                    <td>${item.author}</td>
                    <td>
                        <div class="quantity-control">
                            <button onclick="updateQuantity(${index}, -1)">-</button>
                            <input type="number" value="${item.quantity || 1}" min="1" 
                                   onchange="updateQuantity(${index}, this.value - (item.quantity || 1))">
                            <button onclick="updateQuantity(${index}, 1)">+</button>
                        </div>
                    </td>
                    <td>${(item.price * (item.quantity || 1)).toFixed(2)} ALL</td>
                    <td><i class="bi bi-trash remove-item" onclick="removeItem(${index})"></i></td>
                `;
                cartTableBody.appendChild(row);
                subtotal += item.price * (item.quantity || 1);
            });

            // Update totals
            const shipping = subtotal > 0 ? 200.00 : 0;
            const total = subtotal + shipping;

            subtotalElement.textContent = `${subtotal.toFixed(2)} ALL`;
            shippingElement.textContent = `${shipping.toFixed(2)} ALL`;
            totalElement.textContent = `${total.toFixed(2)} ALL`;
        }

        // Initialize cart display
        updateCartDisplay();

        // Handle checkout
        checkoutBtn.addEventListener('click', function() {
            if (cart.length === 0) {
                // Create toast container if it doesn't exist
                let toastContainer = document.querySelector('.toast-container');
                if (!toastContainer) {
                    toastContainer = document.createElement('div');
                    toastContainer.className = 'toast-container position-fixed bottom-0 end-0 p-3';
                    toastContainer.style.zIndex = '11';
                    document.body.appendChild(toastContainer);
                }

                const toastEl = document.createElement('div');
                toastEl.className = 'toast';
                toastEl.setAttribute('role', 'alert');
                toastEl.setAttribute('aria-live', 'assertive');
                toastEl.setAttribute('aria-atomic', 'true');
                
                toastEl.innerHTML = `
                    <div class="toast-header bg-danger text-white">
                        <strong class="me-auto">Gabim!</strong>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast" aria-label="Close"></button>
                    </div>
                    <div class="toast-body">
                        Shporta juaj është bosh!
                    </div>
                `;

                toastContainer.appendChild(toastEl);
                const toast = new bootstrap.Toast(toastEl, {
                    autohide: true,
                    delay: 3000
                });
                toast.show();

                toastEl.addEventListener('hidden.bs.toast', () => {
                    toastEl.remove();
                });
                return;
            }

            // Create toast container if it doesn't exist
            let toastContainer = document.querySelector('.toast-container');
            if (!toastContainer) {
                toastContainer = document.createElement('div');
                toastContainer.className = 'toast-container position-fixed bottom-0 end-0 p-3';
                toastContainer.style.zIndex = '11';
                document.body.appendChild(toastContainer);
            }

            const toastEl = document.createElement('div');
            toastEl.className = 'toast';
            toastEl.setAttribute('role', 'alert');
            toastEl.setAttribute('aria-live', 'assertive');
            toastEl.setAttribute('aria-atomic', 'true');
            
            toastEl.innerHTML = `
                <div class="toast-header bg-success text-white">
                    <strong class="me-auto">Sukses!</strong>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast" aria-label="Close"></button>
                </div>
                <div class="toast-body">
                    Faleminderit për porosinë! Do të ju kontaktojmë së shpejti.
                </div>
            `;

            toastContainer.appendChild(toastEl);
            const toast = new bootstrap.Toast(toastEl, {
                autohide: true,
                delay: 3000
            });
            toast.show();

            toastEl.addEventListener('hidden.bs.toast', () => {
                toastEl.remove();
                localStorage.removeItem('cart');
                updateCartDisplay();
            });
        });
    });

    // Update item quantity
    function updateQuantity(index, change) {
        const cart = JSON.parse(localStorage.getItem('cart')) || [];
        if (cart[index]) {
            cart[index].quantity = (cart[index].quantity || 1) + change;
            if (cart[index].quantity < 1) cart[index].quantity = 1;
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartDisplay();
        }
    }

    // Remove item from cart
    function removeItem(index) {
        const cart = JSON.parse(localStorage.getItem('cart')) || [];
        cart.splice(index, 1);
        localStorage.setItem('cart', JSON.stringify(cart));
        updateCartDisplay();
    }

    // Update cart display
    function updateCartDisplay() {
        const cart = JSON.parse(localStorage.getItem('cart')) || [];
        const emptyCart = document.getElementById('emptyCart');
        const cartItems = document.getElementById('cartItems');
        const cartTableBody = document.getElementById('cartTableBody');
        const subtotalElement = document.getElementById('subtotal');
        const shippingElement = document.getElementById('shipping');
        const totalElement = document.getElementById('total');

        if (cart.length === 0) {
            emptyCart.style.display = 'block';
            cartItems.style.display = 'none';
            return;
        }

        emptyCart.style.display = 'none';
        cartItems.style.display = 'block';

        // Clear existing items
        cartTableBody.innerHTML = '';

        let subtotal = 0;

        // Add each item to the table
        cart.forEach((item, index) => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td><img src="${item.image}" alt="${item.title}" class="cart-item-image"></td>
                <td>${item.title}</td>
                <td>${item.author}</td>
                <td>
                    <div class="quantity-control">
                        <button onclick="updateQuantity(${index}, -1)">-</button>
                        <input type="number" value="${item.quantity || 1}" min="1" 
                               onchange="updateQuantity(${index}, this.value - (item.quantity || 1))">
                        <button onclick="updateQuantity(${index}, 1)">+</button>
                    </div>
                </td>
                <td>${(item.price * (item.quantity || 1)).toFixed(2)} ALL</td>
                <td><i class="bi bi-trash remove-item" onclick="removeItem(${index})"></i></td>
            `;
            cartTableBody.appendChild(row);
            subtotal += item.price * (item.quantity || 1);
        });

        // Update totals
        const shipping = subtotal > 0 ? 200.00 : 0;
        const total = subtotal + shipping;

        subtotalElement.textContent = `${subtotal.toFixed(2)} ALL`;
        shippingElement.textContent = `${shipping.toFixed(2)} ALL`;
        totalElement.textContent = `${total.toFixed(2)} ALL`;
    }
</script>
</body>
</html> 